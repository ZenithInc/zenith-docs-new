# BASE 理论

之前我们已经说过了 CAP 理论了，指的是在分布式系统中，一致性、分区容错性、可用性三者之间不可能同时满足。一致性和可用性之间只能二选一（CP 或者 AP）。

这篇文档我们继续来讨论一致性以及 CAP 理论延伸出的 Base 理论。

## 强一致性和弱一致性 {id="consistency"}

为了同时满足 CAP 三个指标，有时候我们可以牺牲强一致性改为弱一致性。根据一致性的强弱可以分为三种，从强到弱分别为严格一致性、顺序一致性以及最终一致性：

![](http://file-linker.oss-cn-hangzhou.aliyuncs.com/PcpztaPg3j0UtJhLNa1k.svg)

其中严格一致性指的是任意时刻任意节点，读取到的数据都必须是一致的。但是这种情况下，将无法实现可用性。

退而求其次，我们采用顺序一致性，这指的是系统中所有的操作（无论是读还是写）看上去都应该遵循单一的全局的顺序发生的。比如说 A 在时间上早于另一节点上的 B 操作，那么在所有节点上我们都应该能观察到 A 早于 B。

最终一致性是最弱的一致性，在业务所能容忍的时间范围内，达到最终一致。

## Base 理论 {id="base"}

Base 这个单词并不是“基本”的意思，而是由三个单词构成:

![](http://file-linker.oss-cn-hangzhou.aliyuncs.com/iGrGkFdL7YCRNt1DXz7P.svg)

系统能不能存在软状态以及能否接受最终一致性，这都是需要结合具体的业务场景的。

## 总结 {id="summary"}

BASE 理论是对 CAP 理论的一种补充，特别是针对那些不能满足传统 ACID（原子性、一致性、隔离性、持久性）属性的大规模分布式系统。BASE 代表的是基本可用（Basically Available）、软状态（Soft state）、最终一致性（Eventually consistent）三个特征，旨在提供一种更加灵活的数据存储解决方案，特别是在高可用性和分布式处理是首要考虑的情况下。以下是 BASE 理论的三个关键特性的总结：

* 基本可用（Basically Available）
    - **定义**：基本可用指的是系统保证核心可用，即使由于故障的存在，系统功能可能出现一定程度的退化，但仍能保持基本的运行。例如，在网络分区发生时，系统可能只提供部分功能，或响应时间比平常更长。
    - **实际意义**：在分布式系统中，完全的可用性很难达到，尤其是在网络故障或其他问题出现时。基本可用的概念接受在异常情况下服务可能会降级，但应保证服务的主体可用。

* 软状态（Soft state）
    - **定义**：软状态意味着系统的状态不需要实时保持一致，系统中的数据可能会因为没有即时同步而存在短暂的不一致状态。
    - **实际意义**：在分布式系统中，由于各种原因（如网络延迟、分区故障等），保持所有节点的数据实时一致是非常困难的。软状态的概念允许系统在没有即时通信的情况下继续运行，承认数据的一致性可能会有延迟。

* 最终一致性（Eventually Consistent）
    - **定义**：最终一致性是指，系统保证在没有新的更新操作的情况下，经过足够的时间，所有的副本最终都将达到一致的状态。
    - **实际意义**：这意味着系统不保证立即达到数据的完全一致性，但承诺最终所有数据的副本都将同步。这是一种适用于大规模分布式系统的一致性模型，特别是在高性能和可伸缩性要求下。

BASE 理论通过放宽对一致性的严格要求，提供了一种更加灵活和适应大规模分布式环境的数据管理策略。这种理论强调通过牺牲一定的一致性，来获得更高的系统可用性和可伸缩性。在实际应用中，选择 ACID 还是 BASE，或者如何在两者之间取得平衡，取决于应用的特定需求、数据模型和用户对数据一致性的容忍度。